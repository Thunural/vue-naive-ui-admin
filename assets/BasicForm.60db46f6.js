var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,r=(e,t)=>{for(var l in t||(t={}))s.call(t,l)&&n(e,l,t[l]);if(a)for(var l of a(t))o.call(t,l)&&n(e,l,t[l]);return e},i=(e,t,l)=>new Promise(((a,s)=>{var o=e=>{try{r(l.next(e))}catch(t){s(t)}},n=e=>{try{r(l.throw(e))}catch(t){s(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,n);r((l=l.apply(e,t)).next())}));import{_ as u}from"./Icon.6e18bc20.js";import{u as d,bu as c,bv as f,bw as p,bx as m,by as b,s as g,aH as v,bz as h,bA as y,bB as P,bC as k,bD as N,bE as M,a$ as x,bF as F,bG as O,bH as w,bI as I,bJ as j,bK as B,bL as S,bM as _,bt as R,aP as C,G as V,v as D,r as T,aV as G,q as A,a2 as E,y as U,bs as L,V as q,W as z,X as $,Y as J,a9 as H,ab as W,b6 as K,ac as Q,Z as X,aa as Y,aF as Z,as as ee,ap as te,af as le,N as ae,ad as se,bh as oe,aO as ne,aq as re,aJ as ie,aL as ue,bN as de,bO as ce,bP as fe,bQ as pe,aI as me,aM as be,aK as ge,bn as ve,aN as he,aQ as ye}from"./vendor.07696a3b.js";import{p as Pe,A as ke,B as Ne,D as Me,E as xe,b as Fe,F as Oe,m as we,G as Ie,H as je}from"./index.da21496c.js";import{p as Be}from"./propTypes.eec1be73.js";import{u as Se}from"./useBreakpoint.51186afa.js";const _e={disabled:Be.bool.def(!1),require:Be.bool.def(!1),rulesMessageJoinLabel:Be.bool.def(!0),labelWidth:Be.stringNumber.def(80),schemas:{type:[Array],default:()=>[]},inline:Be.bool.def(!1),size:Be.string.def("medium"),labelPlacement:Be.string,isFull:Be.bool.def(!0),showActionButtonGroup:Be.bool.def(!0),showResetButton:Be.bool.def(!0),resetButtonOptions:Object,showSubmitButton:Be.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:Be.bool.def(!0),submitButtonText:Be.string,resetButtonText:Be.string,gridProps:Object,giProps:Object,formItemProps:Object,baseGridStyle:Object,collapsed:Be.bool.def(!1),collapsedRows:Be.number.def(1)},Re=new Map;Re.set("NInput",v),Re.set("NDynamicInput",h),Re.set("NInputGroup",y),Re.set("NInputGroupLabel",P),Re.set("NInputNumber",k),Re.set("NAutoComplete",N),Re.set("NSelect",M),Re.set("NSwitch",x),Re.set("NCascader",F),Re.set("NSlider",O),Re.set("NRate",w),Re.set("NTransfer",I),Re.set("NTreeSelect",j),Re.set("NDatePicker",B),Re.set("NTimePicker",S),Re.set("NColorPicker",_),Re.set("NUpload",R),Re.set("NDivider",C);var Ce=we(V({name:"BasicForm",props:r({},_e),emits:["reset","submit","register"],setup(e,{emit:n,attrs:u}){const{t:v}=Fe(),{smaller:h,sizeEnum:y}=Se(),P=D({}),k=T({}),N=D({}),M=D(null),x=D(null),F=D(!1),O=D(!1),w=G((()=>h(y.MD).value?"top":"left")),I=A((()=>{const t=Object.assign({},e,d(N)),l={rules:{}};return(t.schemas||[]).forEach((e=>{const t=function(e){const{rules:t=[],show:l,required:a,component:s}=e;let o=E(t);const n=["blur","input"],r=B(e);function i(e,t){const l=e.message||r;return void 0===t||Ie(t)||Array.isArray(t)&&0===t.length||"string"==typeof t&&""===t.trim()||"object"==typeof t&&Reflect.has(t,"checked")&&Reflect.has(t,"halfChecked")&&Array.isArray(t.checked)&&Array.isArray(t.halfChecked)&&0===t.checked.length&&0===t.halfChecked.length?Promise.reject(l):Promise.resolve()}o&&0!==o.length||!a||(o=[{required:a,validator:i,trigger:n}]);const u=o.findIndex((e=>Reflect.has(e,"required")&&!Reflect.has(e,"validator")));if(-1!==u){const e=o[u];Oe(l)&&!l&&(e.required=!1),s&&(Reflect.has(e,"type")||function(e,t,l=!0){switch(t){case"NDatePicker":case"NTimePicker":e.type=l?"string":"object";break;case"NUpload":case"NCheckboxGroup":case"NDateRangePicker":e.type="array";break;case"NInputNumber":e.type="number"}}(e,s),e.message=e.message||r,e.trigger=n,s.includes("NInput")&&(e.whitespace=!0))}const d=o.findIndex((e=>e.max));-1===d||o[d].validator||(o[d].message=o[d].message||v("component.form.maxTip",[o[d].max]));return o}(e);g(l.rules,e.field,t)})),r(r({},t),d(l))})),j=A((()=>{const{schemas:e}=d(I);return{schemas:e,model:d(k)}}));function B(t){const{rulesMessageJoinLabel:l,label:a,component:s}=t,{rulesMessageJoinLabel:o}=e,n=Reflect.has(t,"rulesMessageJoinLabel")?l:o;return`${function(e){return e?["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":"请输入":""}(s)}${n&&null!=a?a:""}`}function S(e){var t;const{disabled:l}=e,{disabled:a}=d(I);return Pe(l)?l(j.value):null!=(t=null!=l?l:a)&&t}const _=A((()=>Object.assign({size:e.size,type:"default"},N.value.resetButtonOptions))),R=A((()=>Object.assign({size:e.size,type:"primary"},N.value.submitButtonOptions))),C=A((()=>d(I).inline)),V=A((()=>{const{gridProps:e}=d(I);return r({responsive:"screen",collapsed:!!C.value&&F.value,cols:1},e)}));const q=A((()=>{const n=d(I),{labelPlacement:i}=n,c=((e,t)=>{var l={};for(var n in e)s.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&a)for(var n of a(e))t.indexOf(n)<0&&o.call(e,n)&&(l[n]=e[n]);return l})(n,["labelPlacement"]);return f=r(r(r({},u),e),c),p={labelPlacement:null!=i?i:w.value},t(f,l(p));var f,p})),z=A((()=>{const e=d(M)||d(I).schemas;for(const t of e){const{defaultValue:e}=t;e&&(t.defaultValue=e)}return e})),{handleFormValues:$,initDefault:J}=function({defaultFormModel:e,getSchema:t,formModel:l}){return{handleFormValues:function(e){if(!ke(e))return{};const t={};for(const l of Object.entries(e)){let[,e]=l;const[a]=l;!a||Ne(e)&&0===e.length||Pe(e)||Me(e)||(xe(e)&&(e=e.trim()),g(t,a,e))}return t},initDefault:function(){const a=d(t),s={},o=e=>{e.forEach((e=>{const{defaultValue:t,childrens:a}=e;Me(t)||(g(s,e.field,t),g(l,e.field,t)),a&&(null==a?void 0:a.length)>0&&o(a)}))};o(a),e.value=s}}}({defaultFormModel:P,getSchema:z,formModel:k}),{handleSubmit:H,validate:W,resetFields:K,getFieldsValue:Q,clearValidate:X,setFieldsValue:Y}=function({emit:e,getProps:t,formModel:l,getSchema:a,formElRef:s,defaultFormModel:o,handleFormValues:n}){function r(){return i(this,null,(function*(){var e;return null==(e=d(s))?void 0:e.validate()}))}function u(a){return i(this,null,(function*(){a&&a.preventDefault();const{submitFunc:o}=d(t);if(o&&Pe(o))yield o(l);else if(d(s))try{return yield r(),e("submit",l),l}catch(n){return!1}}))}function g(){return i(this,null,(function*(){var e;yield null==(e=d(s))?void 0:e.restoreValidation()}))}return{handleSubmit:u,validate:r,resetFields:function(){return i(this,null,(function*(){const{resetFunc:r,submitOnReset:i}=d(t);if(r&&Pe(r)&&(yield r()),!d(s))return;d(a).forEach((e=>{c(l,e.field,(()=>b(o.value,e.field)||null))})),yield g();const f=n(l);e("reset",f),i&&(yield u())}))},getFieldsValue:function(){return d(s)?n(l):{}},clearValidate:g,setFieldsValue:function(e){return i(this,null,(function*(){const t=d(a).map((e=>f(e.field)?e.field[0]:e.field)).filter(Boolean);Object.keys(e).forEach((a=>{const s=e[a];t.includes(a)&&(l[a]=p(s)?m(l[a],s):s)}))}))}}}({emit:n,getProps:I,formModel:k,getSchema:z,formElRef:x,defaultFormModel:P,handleFormValues:$});const Z={getFieldsValue:Q,setFieldsValue:Y,resetFields:K,validate:W,clearValidate:X,setProps:function(e){return i(this,null,(function*(){N.value=je(d(N)||{},e)}))},submit:H};return U((()=>z.value),(e=>{d(O)||(null==e?void 0:e.length)&&(J(),O.value=!0)})),L((()=>{J(),n("register",Z)})),{t:v,get:b,set:g,formElRef:x,formModel:k,getGrid:V,getGridItem:function(e){const{giProps:t}=e,{giProps:l}=d(I);return r(r({span:1},l),t)},getProps:I,getShow:function(e){const{show:t=!0}=e;return Pe(t)?t(j.value):t},getFormItemPath:function(e){return Ne(e)?e.join("."):xe(e)?e:void 0},getBindValue:q,getSchema:z,getSubmitBtnOptions:R,getResetBtnOptions:_,handleSubmit:H,resetFields:K,isInline:C,getComponentProps:function(e){const{component:t,componentProps:l}=e;let a={};switch(t){case null:case void 0:break;case"NInputTextarea":a={type:"textarea"};break;case"NInputPassword":a={type:"password"};break;case"NDateRangePicker":a={type:"daterange"};break;case"NDatetimeRangePicker":a={type:"datetimerange"}}const s=null!=l?l:{};return r(r({clearable:!0,placeholder:B(e),disabled:S(e)},a),s)},getComp:function(e){const{component:t}=e;let l;switch(t){case"NInputTextarea":case"NInputPassword":l="NInput";break;case"NDateRangePicker":case"NDatetimeRangePicker":l="NDatePicker";break;default:l=t}return Re.get(l)},unfoldToggle:function(){F.value=!F.value},componentMap:Re}}}),[["render",function(e,t,l,a,s,o){const n=ne,r=u,i=re,d=ie,c=ue,f=de,p=ce,m=fe,b=pe,g=y,v=me,h=be,P=ge,k=ve,N=he,M=ye;return q(),z(M,X(e.getBindValue,{ref:"formElRef",model:e.formModel,class:"mt-2"}),{default:$((()=>[J(N,Q(se(e.getGrid)),{default:$((()=>[(q(!0),H(K,null,W(e.getSchema,(t=>(q(),H(K,{key:t.field},[e.getShow(t)?(q(),z(h,Q(X({key:0},e.getGridItem(t))),{default:$((()=>[J(v,X({label:t.label,path:e.getFormItemPath(t.field)},t.formItemProps),Y({default:$((()=>[t.slot?ae(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):"NCheckbox"===t.component?(q(),z(f,{key:1,value:e.formModel[t.field],"onUpdate:value":l=>e.formModel[t.field]=l},{default:$((()=>[J(c,null,{default:$((()=>{var e;return[(q(!0),H(K,null,W(null==(e=null==t?void 0:t.componentProps)?void 0:e.options,(e=>(q(),z(d,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))]})),_:2},1024)])),_:2},1032,["value","onUpdate:value"])):"NRadioGroup"===t.component?(q(),z(m,{key:2,value:e.formModel[t.field],"onUpdate:value":l=>e.formModel[t.field]=l},{default:$((()=>{var e;return[J(c,Q(se(null==(e=null==t?void 0:t.componentProps)?void 0:e.spaceProps)),{default:$((()=>{var e;return[(q(!0),H(K,null,W(null==(e=null==t?void 0:t.componentProps)?void 0:e.options,(e=>(q(),z(p,{key:e.value,value:e.value},{default:$((()=>[Z(ee(e.label),1)])),_:2},1032,["value"])))),128))]})),_:2},1040)]})),_:2},1032,["value","onUpdate:value"])):"NRadioButtonGroup"===t.component?(q(),z(m,{key:3,value:e.formModel[t.field],"onUpdate:value":l=>e.formModel[t.field]=l},{default:$((()=>{var e;return[(q(!0),H(K,null,W(null==(e=null==t?void 0:t.componentProps)?void 0:e.options,(e=>(q(),z(b,{key:e.value,value:e.value},{default:$((()=>[Z(ee(e.label),1)])),_:2},1032,["value"])))),128))]})),_:2},1032,["value","onUpdate:value"])):"NInputGroup"===t.component?(q(),z(g,{key:4},{default:$((()=>[(q(!0),H(K,null,W(t.childrens,(l=>{var a,s;return q(),z(oe(e.getComp(l)),X({key:l.filed},e.getComponentProps(l),{value:e.get(e.formModel,null!=(a=l.field)?a:t.field),"onUpdate:value":a=>{var s;return e.set(e.formModel,null!=(s=l.field)?s:t.field,a)},class:{isFull:0!=(null!=(s=l.isFull)?s:t.isFull)&&e.getProps.isFull}}),{default:$((()=>[Z(ee(null==l?void 0:l.defaultSlot),1)])),_:2},1040,["value","onUpdate:value","class"])})),128))])),_:2},1024)):(q(),z(oe(e.getComp(t)),X({key:5},e.getComponentProps(t),{value:e.get(e.formModel,t.field),"onUpdate:value":l=>e.set(e.formModel,t.field,l),class:{isFull:0!=t.isFull&&e.getProps.isFull}}),null,16,["value","onUpdate:value","class"])),t.suffix?ae(e.$slots,t.suffix,{key:6,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):te("",!0)])),_:2},[t.subLabel||t.labelMessage?{name:"label",fn:$((()=>[Z(ee(t.label)+" ",1),t.subLabel?(q(),z(n,{key:0,depth:3,class:"mr-2"},{default:$((()=>[Z(ee(t.subLabel),1)])),_:2},1024)):te("",!0),t.labelMessage?(q(),z(i,{key:1,trigger:"hover",style:le(t.labelMessageStyle)},{trigger:$((()=>[J(r,{icon:"ant-design:question-circle-outlined",class:"text-18px cursor-pointer text-$app-text-color-3"})])),default:$((()=>[Z(" "+ee(t.labelMessage),1)])),_:2},1032,["style"])):te("",!0)]))}:void 0]),1040,["label","path"])])),_:2},1040)):te("",!0)],64)))),128)),e.getProps.showActionButtonGroup?(q(),z(h,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:$((({overflow:t})=>[J(c,{align:"center",justify:e.isInline?"end":"start",style:le({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`,"margin-bottom":"24px"})},{default:$((()=>[e.getProps.showSubmitButton?(q(),z(P,X({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit}),{default:$((()=>{var t;return[Z(ee(null!=(t=e.getProps.submitButtonText)?t:e.t("common.queryText")),1)]})),_:1},16,["onClick"])):te("",!0),e.getProps.showResetButton?(q(),z(P,X({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:$((()=>{var t;return[Z(ee(null!=(t=e.getProps.resetButtonText)?t:e.t("common.resetText")),1)]})),_:1},16,["onClick"])):te("",!0),e.isInline&&e.getProps.showAdvancedButton?(q(),z(P,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:$((()=>[t?(q(),z(k,{key:0,size:"14",class:"unfold-icon"},{default:$((()=>[J(r,{icon:"ant-design:down-outlined"})])),_:1})):(q(),z(k,{key:1,size:"14",class:"unfold-icon"},{default:$((()=>[J(r,{icon:"ant-design:up-outlined"})])),_:1}))])),default:$((()=>[Z(" "+ee(t?"展开":"收起"),1)])),_:2},1032,["onClick"])):te("",!0)])),_:2},1032,["justify","style"])])),_:1},8,["span","suffix"])):te("",!0)])),_:3},16)])),_:3},16,["model"])}],["__scopeId","data-v-a40a950a"]]);export{Ce as _};
