var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,s=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))a.call(t,n)&&r(e,n,t[n]);return e},i=(e,l)=>t(e,n(l)),c=(e,t,n)=>new Promise(((l,o)=>{var a=e=>{try{s(n.next(e))}catch(t){o(t)}},r=e=>{try{s(n.throw(e))}catch(t){o(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,r);s((n=n.apply(e,t)).next())}));import{_ as u}from"./ScrollContainer.b994555d.js";import{u as p,_ as d,e as f}from"./useWindowSizeFn.12b67c52.js";import{v as g,ar as h,G as m,ba as y,r as b,bs as v,c5 as w,c6 as S,I as C,c7 as k,q as x,u as H,y as F,bR as B,w as O,bV as M,V as P,W as j,X as N,a7 as R,a9 as W,N as $,af as T,Z as _,aF as I,as as A,ap as D,aK as L,aL as E,b6 as z,ao as q,Y as V,ae as X,aq as Y,c3 as K,A as Z,bg as G,bS as U,o as J,R as Q,aa as ee,ab as te,ac as ne,ad as le,b0 as oe}from"./vendor.07696a3b.js";import{t as ae,m as re,b as se,p as ie,H as ce}from"./index.5eb97f6e.js";import{_ as ue}from"./Icon.6be87540.js";import{u as pe}from"./useDesign.2e5b3993.js";const de=Symbol();m({name:"LazyContainer",components:{NSkeleton:y},inheritAttrs:!1,props:{timeout:{type:Number},viewport:{type:"undefined"!=typeof window?window.HTMLElement:Object,default:()=>null},threshold:{type:String,default:"0px"},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},tag:{type:String,default:"div"},maxWaitingTime:{type:Number,default:80},transitionName:{type:String,default:"lazy-container"}},emits:["init"],setup(e,{emit:t}){const n=g(),l=b({isInit:!1,loading:!1,intersectionObserverInstance:null});function o(){l.loading=!0,w((()=>{l.isInit||(l.isInit=!0,t("init"))}),e.maxWaitingTime||80)}return v((()=>{!function(){const{timeout:t}=e;t&&w((()=>{o()}),t)}(),function(){const{timeout:t,direction:l,threshold:a}=e;if(t)return;let r="0px";switch(l){case"vertical":r=`${a} 0px`;break;case"horizontal":r=`0px ${a}`}try{const{stop:t,observer:l}=function({target:e,root:t,onIntersect:n,rootMargin:l="0px",threshold:o=.1}){let a=()=>{};const r=g(null),s=h((()=>{a(),r.value=new IntersectionObserver(n,{root:t?t.value:null,rootMargin:l,threshold:o});const s=e.value;s&&r.value.observe(s),a=()=>{r.value&&(r.value.disconnect(),e.value&&r.value.unobserve(e.value))}}));return{observer:r,stop:()=>{a(),s()}}}({rootMargin:r,target:S(n.value,"$el"),onIntersect:e=>{(e[0].isIntersecting||e[0].intersectionRatio)&&(o(),l&&t())},root:S(e,"viewport")})}catch(s){o()}}()})),s({elRef:n},C(l))}});const fe={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},show:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},ge=m({name:"ModalWrapper",components:{ScrollContainer:u},inheritAttrs:!1,props:fe,emits:["height-change","ext-height"],setup(e,{emit:t}){const n=g(null),l=g(null),o=g(0),a=g(0);let r=0;p(i.bind(null,!1)),k(l,(()=>{i()}),{attributes:!0,subtree:!0}),ae({redoModalHeight:i},de);const s=x((()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${H(o)}px`})));function i(){return c(this,null,(function*(){if(e.show)try{let n=window.innerHeight-100-(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;yield O();const a=H(l);if(!a)return;yield O(),r=a.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:r>n?n:r,t("height-change",H(o))}catch(n){}}))}return h((()=>{e.useWrapper&&i()})),F((()=>e.fullScreen),(e=>{i(),e?a.value=o.value:o.value=a.value})),v((()=>{const{modalHeaderHeight:n,modalFooterHeight:l}=e;t("ext-height",n+l)})),B((()=>{})),{wrapperRef:n,spinRef:l,spinStyle:s,setModalHeight:i}}}),he=["loading-tip"];var me=re(ge,[["render",function(e,t,n,l,o,a){const r=u,s=M("loading");return P(),j(r,{ref:"wrapperRef"},{default:N((()=>[R((P(),W("div",{ref:"spinRef",style:T(e.spinStyle),"loading-tip":e.loadingTip},[$(e.$slots,"default")],12,he)),[[s,e.loading]])])),_:3},512)}]]);const{t:ye}=se(),be={show:{type:Boolean},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ye("common.cancelText")},okText:{type:String,default:ye("common.okText")},closeFunc:Function},ve=Object.assign({},be,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},tipsMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,onAfterLeave:Function,contentStyle:Object,confirmLoading:{type:Boolean},to:String||HTMLElement,closeOnEsc:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,autoFocus:{type:Boolean,default:!0},title:{type:String},show:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});var we=re(m({name:"BasicModalFooter",props:ve,emits:["ok","cancel"],setup:(e,{emit:t})=>({handleOk:function(e){t("ok",e)},handleCancel:function(e){t("cancel",e)}})}),[["render",function(e,t,n,l,o,a){const r=L,s=E;return P(),j(s,{justify:"end"},{default:N((()=>[$(e.$slots,"insertFooter"),e.showCancelBtn?(P(),j(r,_({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:N((()=>[I(A(e.cancelText),1)])),_:1},16,["onClick"])):D("",!0),$(e.$slots,"centerFooter"),e.showOkBtn?(P(),j(r,_({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:N((()=>[I(A(e.okText),1)])),_:1},16,["type","onClick","loading"])):D("",!0),$(e.$slots,"appendFooter")])),_:3})}]]);var Se=re(m({name:"ModalClose",props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:t}){const{prefixCls:n}=pe("basic-modal-close"),{t:l}=se();return{t:l,getClass:x((()=>[n,`${n}--custom`,{[`${n}--can-full`]:e.canFullscreen}])),prefixCls:n,handleCancel:function(e){t("cancel",e)},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),t("fullscreen")}}}}),[["render",function(e,t,n,l,o,a){const r=ue,s=Y;return P(),W("div",{class:X(e.getClass)},[e.canFullscreen?(P(),W(z,{key:0},[e.fullScreen?(P(),j(s,{key:0,placement:"bottom"},{trigger:N((()=>[q("span",null,[V(r,{icon:"ant-design:fullscreen-exit-outlined",role:"full",onClick:e.handleFullScreen},null,8,["onClick"])])])),default:N((()=>[I(" "+A(e.t("component.modal.restore")),1)])),_:1})):(P(),j(s,{key:1,placement:"bottom"},{trigger:N((()=>[q("span",null,[V(r,{class:"text-18px",icon:"ant-design:fullscreen-outlined",role:"full",onClick:e.handleFullScreen},null,8,["onClick"])])])),default:N((()=>[I(" "+A(e.t("component.modal.maximize")),1)])),_:1}))],64)):D("",!0),V(s,{placement:"bottom"},{trigger:N((()=>[q("span",null,[V(r,{class:"text-18px",icon:"ant-design:close-outlined",role:"close",onClick:e.handleCancel},null,8,["onClick"])])])),default:N((()=>[I(" "+A(e.t("component.modal.close")),1)])),_:1})],2)}]]);var Ce=re(m({name:"BasicModalHeader",props:{tipsMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"],setup:(e,{emit:t})=>({handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),t("dblclick")}})}),[["render",function(e,t,n,l,o,a){const r=d;return P(),j(r,{tipsMessage:e.tipsMessage,onDblclick:e.handleFullScreen},{default:N((()=>[I(A(e.title),1)])),_:1},8,["tipsMessage","onDblclick"])}]]);function ke(e){const t=function(e,t){return getComputedStyle(e)[t]},n={left:0,top:0,currentX:0,currentY:0,flag:!1},l=l=>{if(!l)return;l.setAttribute("data-drag",H(e.draggable));const o=l.querySelector(".n-card-header ,.n-dialog__title"),a=l.querySelector(".n-modal");if(!o||!a||!H(e.draggable))return;const r=o.querySelector(".aso-basic-title");o.style.cursor="move",r.style.cursor="move";const s=document.body.clientWidth,i=document.documentElement.clientHeight,c=a.offsetWidth,u=a.offsetHeight,p=a.offsetLeft,d=a.offsetTop,f=s-p-c,g=i-d-u;"auto"!==t(a,"left")&&(n.left=t(a,"left")),"auto"!==t(a,"top")&&(n.top=t(a,"top")),o.onmousedown=function(e){n.flag=!0,e||(e=window.event,o.onselectstart=function(){return!1});const t=e;n.currentX=t.clientX,n.currentY=t.clientY},document.onmouseup=function(){n.flag=!1,"auto"!==t(a,"left")&&(n.left=t(a,"left")),"auto"!==t(a,"top")&&(n.top=t(a,"top"))},document.onmousemove=function(e){const t=e||window.event;if(n.flag){const l=t.clientX,o=t.clientY,r=l-n.currentX,s=o-n.currentY;let i=parseInt(n.left)+r,c=parseInt(n.top)+s;return-i>p?i=-p:i>f&&(i=f),-c>d?c=-d:c>g&&(c=g),a.style.left=`${i}px`,a.style.top=`${c}px`,e.preventDefault&&e.preventDefault(),!1}}};h((()=>{H(e.show)&&H(e.draggable)&&w((()=>{(()=>{const e=document.querySelectorAll(".n-modal-body-wrapper");for(const n of Array.from(e)){if(!n)continue;const e=t(n,"display"),o=n.getAttribute("data-drag");"none"!==e&&null===o&&l(n)}})()}),30)}))}const xe=["class","style"],He=/^on[A-Z]/;function Fe(e={}){const t=Z();if(!t)return{};const{excludeListeners:n=!1,excludeKeys:l=[],excludeDefaultKeys:o=!0}=e,a=K({}),r=l.concat(o?xe:[]);return t.attrs=b(t.attrs),h((()=>{const e=(l=t.attrs,Object.keys(l).map((e=>[e,l[e]]))).reduce(((e,[t,l])=>(r.includes(t)||n&&He.test(t)||(e[t]=l),e)),{});var l;a.value=e})),a}var Be=m({name:"Modal",inheritAttrs:!1,props:ve,emits:["cancel"],setup(e,{slots:t}){const{show:n,draggable:l}=C(e),o=Fe();return ke({show:n,draggable:l}),()=>{let n;const l=s(s({},H(o)),e);return V(U,l,"function"==typeof(a=n=f(t))||"[object Object]"===Object.prototype.toString.call(a)&&!G(a)?n:{default:()=>[n]});var a}}});const Oe=m({name:"BasicModal",components:{Modal:Be,ModalWrapper:me,ModalClose:Se,ModalFooter:we,ModalHeader:Ce},inheritAttrs:!1,props:ve,emits:["show-change","height-change","cancel","ok","register","update:show"],setup(e,{emit:t,attrs:n}){const l=g(!1),o=g(null),a=g(null),{prefixCls:r}=pe("basic-modal"),u=g(0),p={setModalProps:function(e){o.value=ce(H(o)||{},e),Reflect.has(e,"show")&&(l.value=!!e.show);Reflect.has(e,"defaultFullscreen")&&(b.value=!!e.defaultFullscreen)},emitShow:void 0,redoModalHeight:()=>{O((()=>{H(a)&&H(a).setModalHeight()}))}},d=Z();d&&t("register",p,d.uid);const f=x((()=>s(s({},e),H(o)))),{handleFullScreen:m,getWrapClassName:y,fullScreenRef:b}=function(e){const t=g(!1);return{getWrapClassName:x((()=>{const n=H(e.wrapClassName)||"";return H(t)?`fullscreen-modal ${n} `:H(n)})),handleFullScreen:function(e){e&&e.stopPropagation(),t.value=!H(t)},fullScreenRef:t}}({modalWrapperRef:a,extHeightRef:u,wrapClassName:S(f.value,"wrapClassName")}),v=x((()=>{const e=i(s({},H(f)),{show:H(l),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return i(s({},e),{wrapClassName:H(y)})})),w=x((()=>{const e=i(s(s({},n),H(f)),{show:H(l),wrapClassName:H(y)});return H(b)?J(e,["height","title"]):J(e,"title")})),C=x((()=>{if(!H(b))return H(v).height}));return h((()=>{l.value=!!e.show,b.value=!!e.defaultFullscreen})),F((()=>H(l)),(e=>{var n;t("show-change",e),t("update:show",e),d&&(null==(n=p.emitShow)||n.call(p,e,d.uid))}),{immediate:!1}),{prefixCls:r,handleCancel:function(n){return c(this,null,(function*(){var o,a;if(null==n||n.stopPropagation(),!(null==(a=null==(o=n.target)?void 0:o.classList)?void 0:a.contains(r+"-close--custom")))if(e.closeFunc&&ie(e.closeFunc)){const t=yield e.closeFunc();l.value=!t}else l.value=!1,t("cancel",n)}))},getBindValue:w,getProps:v,handleFullScreen:m,fullScreenRef:b,getMergeProps:f,handleOk:function(e){t("ok",e)},showRef:l,omit:J,modalWrapperRef:a,handleExtHeight:function(e){u.value=e},handleHeightChange:function(e){t("height-change",e)},handleTitleDbClick:function(t){e.canFullscreen&&m(t)},getWrapperHeight:C}}}),Me={class:"w-full"};var Pe=re(Oe,[["render",function(e,t,n,l,o,a){const r=Ce,s=Se,i=we,c=me,u=oe,p=Q("Modal");return P(),j(p,_(e.getBindValue,{onCancel:e.handleCancel,class:e.prefixCls,show:e.showRef,"onUpdate:show":t[0]||(t[0]=t=>e.showRef=t)}),{default:N((()=>[V(u,{bordered:!1,size:"huge",role:"dialog","aria-modal":"true",class:X([e.prefixCls,e.getBindValue.wrapClassName]),style:T({width:e.getProps.width})},ee({header:N((()=>[q("div",Me,[V(r,{title:e.getMergeProps.title,tipsMessage:e.getProps.tipsMessage,onDblclick:e.handleTitleDbClick},null,8,["title","tipsMessage","onDblclick"])])])),"header-extra":N((()=>[V(s,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])])),default:N((()=>[V(c,_({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,show:e.showRef},e.omit(e.getProps.wrapperProps,"show","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:N((()=>[$(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","show","onExtHeight","onHeightChange"])])),_:2},[e.$slots.action?void 0:{name:"action",fn:N((()=>[V(i,_(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),ee({_:2},[te(Object.keys(e.$slots),(t=>({name:t,fn:N((n=>[$(e.$slots,t,ne(le(n||{})))]))})))]),1040,["onOk","onCancel"])]))},te(Object.keys(e.omit(e.$slots,"default")),(t=>({name:t,fn:N((n=>[$(e.$slots,t,ne(le(n||{})))]))})))]),1032,["class","style"])])),_:3},16,["onCancel","class","show"])}]]);export{Pe as _};
