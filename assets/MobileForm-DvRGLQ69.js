var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,r=(e,t,a)=>new Promise(((s,n)=>{var o=e=>{try{r(a.next(e))}catch(t){n(t)}},l=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);r((a=a.apply(e,t)).next())}));import{r as u,es as i,b as c,V as p,d as m,ag as d,i as f,ay as v,o as b,e as g,w as y,q as j,t as h,et as _,B as S,p as w,ce as C,Y as k,bx as x,dm as O,h as z,U as I,M as B,O as F,P,Q as A,R as L,f as q}from"./index-BLWT44Eo.js";import{u as E}from"./useDesign-CZnxk_Lj.js";import{i as T}from"./isEqual-BiDbZAVD.js";import{_ as M}from"./Input-BelaXqkC.js";import{_ as N,a as R}from"./Grid-cihNI7Wf.js";import{u as U,a as $,L as D,b as G}from"./useLogin-DBfde1oQ.js";import{_ as Q,a as V}from"./FormItem-DN9aaP3F.js";import{_ as Y}from"./Space-B9frXtWC.js";import"./_baseIsEqual-BGsWZIhh.js";import"./use-locale-7p-wVYXM.js";import"./use-merged-state-DCdOf7ht.js";import"./use-breakpoints-DcVC2Cdm.js";import"./next-frame-once-DiJwGkuW.js";import"./get-slot-BjAOOWF7.js";import"./format-length-l2rsThpR.js";import"./get-C07Juxwr.js";import"./light-DFJtCmXp.js";const H=p(m({name:"CountButton",props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(e){const t=u(!1),{currentCount:a,isStart:s,start:n,reset:o}=function(e){const t=u(e),a=u(!1);let s;function n(){s&&window.clearInterval(s)}function o(){a.value=!1,n(),s=null}function l(){c(a)||s||(a.value=!0,s=setInterval((()=>{1===c(t)?(o(),t.value=e):t.value-=1}),1e3))}function r(){t.value=e,o()}return i((()=>{r()})),{start:l,reset:r,restart:function(){r(),l()},clear:n,stop:o,currentCount:t,isStart:a}}(e.count),{t:l}=d(),p=f((()=>c(s)?l("component.countdown.sendText",[c(a)]):l("component.countdown.normalText")));return v((()=>{void 0===e.value&&o()})),{handleStart:function(){return r(this,null,(function*(){const{beforeStartFunc:a}=e;if(a&&_(a)){t.value=!0;try{(yield a())&&n()}finally{t.value=!1}}else n()}))},currentCount:a,loading:t,getButtonText:p,isStart:s}}}),[["render",function(e,t,a,s,n,o){const l=S;return b(),g(l,{block:"",disabled:e.isStart,loading:e.loading,onClick:e.handleStart},{default:y((()=>[j(h(e.getButtonText),1)])),_:1},8,["disabled","loading","onClick"])}]]);const J=m((K=((e,t)=>{for(var a in t||(t={}))n.call(t,a)&&l(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&l(e,a,t[a]);return e})({},{name:"CountdownInput",inheritAttrs:!1}),t(K,a({props:{value:String,size:String,count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(e){const t=e,{prefixCls:a}=E("countdown-input"),[s]=function(e,t="value",a="change",s){const n=O(),o=null==n?void 0:n.emit,l=w({value:e[t]}),r=C(l);return v((()=>{l.value=e[t]})),[f({get:()=>l.value,set(e){T(e,r.value)||(l.value=e,k((()=>{null==o||o(a,e,...x(c(s))||[])})))}}),e=>{l.value=e},r]}(t);return(t,n)=>{const o=M,l=N,r=R;return b(),g(r,{cols:"12","x-gap":12},{default:y((()=>[z(l,{span:"8"},{default:y((()=>[z(o,I(t.$attrs,{class:c(a),size:e.size,value:c(s)}),B({_:2},[F(Object.keys(t.$slots),(e=>({name:e,fn:y((a=>[P(t.$slots,e,A(L(a||{})))]))})))]),1040,["class","size","value"])])),_:3}),z(l,{span:"4"},{default:y((()=>[z(H,{size:e.size,count:e.count,value:c(s),"before-start-func":e.sendCodeApi},null,8,["size","count","value","before-start-func"])])),_:1})])),_:3})}}}))));var K;const W=m({__name:"MobileForm",setup(e){const{t:t}=d(),{handleBackLogin:a,getLoginState:s}=U(),{getFormRules:n}=$(),o=u(),l=u(!1),i=w({mobile:"",sms:""}),p=f((()=>c(s)===D.MOBILE));function m(){return r(this,null,(function*(){const{onSuccess:e}=G(o);e((()=>{}))}))}return(e,s)=>{const r=M,u=Q,d=J,f=S,v=Y,_=V;return p.value?(b(),g(_,{key:0,ref_key:"formRef",ref:o,class:"p-4 enter-x","show-label":!1,model:i,rules:c(n)},{default:y((()=>[z(u,{label:"mobile",path:"mobile"},{default:y((()=>[z(r,{value:i.mobile,"onUpdate:value":s[0]||(s[0]=e=>i.mobile=e),size:"large",placeholder:c(t)("sys.login.mobile")},null,8,["value","placeholder"])])),_:1}),z(u,{label:"sms",path:"sms"},{default:y((()=>[z(d,{value:i.sms,"onUpdate:value":s[1]||(s[1]=e=>i.sms=e),size:"large",placeholder:c(t)("sys.login.smsCode")},null,8,["value","placeholder"])])),_:1}),z(v,{vertical:""},{default:y((()=>[z(f,{type:"primary",size:"large",block:"",loading:l.value,onClick:m},{default:y((()=>[j(h(c(t)("sys.login.loginButton")),1)])),_:1},8,["loading"]),z(f,{size:"large",block:"",class:"mt-4",onClick:c(a)},{default:y((()=>[j(h(c(t)("sys.login.backSignIn")),1)])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])):q("",!0)}}});export{W as default};
