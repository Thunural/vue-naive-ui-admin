import{p as e,ce as n,cd as t,E as o,cc as r,cf as i,b2 as l,aA as s,d as a,eA as d,D as c,dG as u,dH as f,i as p,r as h,cn as v,bL as g,bU as m,k as y,co as b,U as k,Y as w,P as x,cp as S,s as N,cE as R,ao as z,aD as C,y as F,A as T,z as P,x as O,ai as M,ax as L,G as A,C as E,aj as B,F as K,fb as I,a8 as j,bP as $,a5 as G,H as D,a9 as H,eY as _,aL as W,aa as U}from"./index-BLWT44Eo.js";import{c as q,a as V}from"./cssr-Bn6OPr4i.js";import{i as Y,d as X}from"./Tooltip-anTY7wtM.js";import{F as J}from"./Checkmark-COOfFbaS.js";import{b as Q}from"./next-frame-once-DiJwGkuW.js";import{_ as Z}from"./Empty-BfqMuUzh.js";function ee(e,n){let{target:t}=e;for(;t;){if(t.dataset&&void 0!==t.dataset[n])return!0;t=t.parentElement}return!1}function ne(e){const n=e.filter((e=>void 0!==e));if(0!==n.length)return 1===n.length?n[0]:n=>{e.forEach((e=>{e&&e(n)}))}}function te(a={},d){const c=e({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:u,keyup:f}=a,p=e=>{switch(e.key){case"Control":c.ctrl=!0;break;case"Meta":c.command=!0,c.win=!0;break;case"Shift":c.shift=!0;break;case"Tab":c.tab=!0}void 0!==u&&Object.keys(u).forEach((n=>{if(n!==e.key)return;const t=u[n];if("function"==typeof t)t(e);else{const{stop:n=!1,prevent:o=!1}=t;n&&e.stopPropagation(),o&&e.preventDefault(),t.handler(e)}}))},h=e=>{switch(e.key){case"Control":c.ctrl=!1;break;case"Meta":c.command=!1,c.win=!1;break;case"Shift":c.shift=!1;break;case"Tab":c.tab=!1}void 0!==f&&Object.keys(f).forEach((n=>{if(n!==e.key)return;const t=f[n];if("function"==typeof t)t(e);else{const{stop:n=!1,prevent:o=!1}=t;n&&e.stopPropagation(),o&&e.preventDefault(),t.handler(e)}}))},v=()=>{(void 0===d||d.value)&&(t("keydown",document,p),t("keyup",document,h)),void 0!==d&&o(d,(e=>{e?(t("keydown",document,p),t("keyup",document,h)):(r("keydown",document,p),r("keyup",document,h))}))};return i()?(l(v),s((()=>{(void 0===d||d.value)&&(r("keydown",document,p),r("keyup",document,h))}))):v(),n(c)}function oe(e){return e&-e}class re{constructor(e,n){this.l=e,this.min=n;const t=new Array(e+1);for(let o=0;o<e+1;++o)t[o]=0;this.ft=t}add(e,n){if(0===n)return;const{l:t,ft:o}=this;for(e+=1;e<=t;)o[e]+=n,e+=oe(e)}get(e){return this.sum(e+1)-this.sum(e)}sum(e){if(void 0===e&&(e=this.l),e<=0)return 0;const{ft:n,min:t,l:o}=this;if(e>o)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let r=e*t;for(;e>0;)r+=n[e],e-=oe(e);return r}getBound(e){let n=0,t=this.l;for(;t>n;){const o=Math.floor((n+t)/2),r=this.sum(o);if(r>e)t=o;else{if(!(r<e))return o;if(n===o)return this.sum(n+1)<=e?n+1:o;n=o}}return n}}let ie,le;function se(){return"undefined"==typeof document?1:(void 0===le&&(le="chrome"in window?window.devicePixelRatio:1),le)}const ae=V(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[V("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[V("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),de=a({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(e){const n=d();ae.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:q,ssr:n}),c((()=>{const{defaultScrollIndex:n,defaultScrollKey:t}=e;null!=n?S({index:n}):null!=t&&S({key:t})}));let t=!1,o=!1;u((()=>{t=!1,o?S({top:k.value,left:b}):o=!0})),f((()=>{t=!0,o||(o=!0)}));const r=p((()=>{const n=new Map,{keyField:t}=e;return e.items.forEach(((e,o)=>{n.set(e[t],o)})),n})),i=h(null),l=h(void 0),s=new Map,a=p((()=>{const{items:n,itemSize:t,keyField:o}=e,r=new re(n.length,t);return n.forEach(((e,n)=>{const t=e[o],i=s.get(t);void 0!==i&&r.add(n,i)})),r})),y=h(0);let b=0;const k=h(0),w=v((()=>Math.max(a.value.getBound(k.value-g(e.paddingTop))-1,0))),x=p((()=>{const{value:n}=l;if(void 0===n)return[];const{items:t,itemSize:o}=e,r=w.value,i=Math.min(r+Math.ceil(n/o+1),t.length-1),s=[];for(let e=r;e<=i;++e)s.push(t[e]);return s})),S=(e,n)=>{if("number"==typeof e)return void C(e,n,"auto");const{left:t,top:o,index:i,key:l,position:s,behavior:a,debounce:d=!0}=e;if(void 0!==t||void 0!==o)C(t,o,a);else if(void 0!==i)z(i,a,d);else if(void 0!==l){const e=r.value.get(l);void 0!==e&&z(e,a,d)}else"bottom"===s?C(0,Number.MAX_SAFE_INTEGER,a):"top"===s&&C(0,0,a)};let N,R=null;function z(n,t,o){const{value:r}=a,l=r.sum(n)+g(e.paddingTop);if(o){N=n,null!==R&&window.clearTimeout(R),R=window.setTimeout((()=>{N=void 0,R=null}),16);const{scrollTop:e,offsetHeight:o}=i.value;if(l>e){const s=r.get(n);l+s<=e+o||i.value.scrollTo({left:0,top:l+s-o,behavior:t})}else i.value.scrollTo({left:0,top:l,behavior:t})}else i.value.scrollTo({left:0,top:l,behavior:t})}function C(e,n,t){i.value.scrollTo({left:e,top:n,behavior:t})}const F=!("undefined"!=typeof document&&(void 0===ie&&(ie="matchMedia"in window&&window.matchMedia("(pointer:coarse)").matches),ie));let T=!1;function P(){const{value:e}=i;null!=e&&(k.value=e.scrollTop,b=e.scrollLeft)}function O(e){let n=e;for(;null!==n;){if("none"===n.style.display)return!0;n=n.parentElement}return!1}return{listHeight:l,listStyle:{overflow:"auto"},keyToIndex:r,itemsStyle:p((()=>{const{itemResizable:n}=e,t=m(a.value.sum());return y.value,[e.itemsStyle,{boxSizing:"content-box",height:n?"":t,minHeight:n?t:"",paddingTop:m(e.paddingTop),paddingBottom:m(e.paddingBottom)}]})),visibleItemsStyle:p((()=>(y.value,{transform:`translateY(${m(a.value.sum(w.value))})`}))),viewportItems:x,listElRef:i,itemsElRef:h(null),scrollTo:S,handleListResize:function(n){if(t)return;if(O(n.target))return;if(n.contentRect.height===l.value)return;l.value=n.contentRect.height;const{onResize:o}=e;void 0!==o&&o(n)},handleListScroll:function(n){var t;null===(t=e.onScroll)||void 0===t||t.call(e,n),F&&T||P()},handleListWheel:function(n){var t;if(null===(t=e.onWheel)||void 0===t||t.call(e,n),F){const e=i.value;if(null!=e){if(0===n.deltaX){if(0===e.scrollTop&&n.deltaY<=0)return;if(e.scrollTop+e.offsetHeight>=e.scrollHeight&&n.deltaY>=0)return}n.preventDefault(),e.scrollTop+=n.deltaY/se(),e.scrollLeft+=n.deltaX/se(),P(),T=!0,Q((()=>{T=!1}))}}},handleItemResize:function(n,o){var l,d,c;if(t)return;if(e.ignoreItemResize)return;if(O(o.target))return;const{value:u}=a,f=r.value.get(n),p=u.get(f),h=null!==(c=null===(d=null===(l=o.borderBoxSize)||void 0===l?void 0:l[0])||void 0===d?void 0:d.blockSize)&&void 0!==c?c:o.contentRect.height;if(h===p)return;0===h-e.itemSize?s.delete(n):s.set(n,h-e.itemSize);const v=h-p;if(0===v)return;u.add(f,v);const g=i.value;if(null!=g){if(void 0===N){const e=u.sum(f);g.scrollTop>e&&g.scrollBy(0,v)}else if(f<N)g.scrollBy(0,v);else if(f===N){h+u.sum(f)>g.scrollTop+g.offsetHeight&&g.scrollBy(0,v)}P()}y.value++}}},render(){const{itemResizable:e,keyField:n,keyToIndex:t,visibleItemsTag:o}=this;return y(b,{onResize:this.handleListResize},{default:()=>{var r,i;return y("div",k(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[0!==this.items.length?y("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[y(o,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>this.viewportItems.map((o=>{const r=o[n],i=t.get(r),l=this.$slots.default({item:o,index:i})[0];return e?y(b,{key:r,onResize:e=>this.handleItemResize(r,e)},{default:()=>l}):(l.key=r,l)}))})]):null===(i=(r=this.$slots).empty)||void 0===i?void 0:i.call(r)])}})}}),ce="v-hidden",ue=V("[v-hidden]",{display:"none!important"}),fe=a({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(e,{slots:n}){const t=h(null),o=h(null);function r(r){const{value:i}=t,{getCounter:l,getTail:s}=e;let a;if(a=void 0!==l?l():o.value,!i||!a)return;a.hasAttribute(ce)&&a.removeAttribute(ce);const{children:d}=i;if(r.showAllItemsBeforeCalculate)for(const e of d)e.hasAttribute(ce)&&e.removeAttribute(ce);const c=i.offsetWidth,u=[],f=n.tail?null==s?void 0:s():null;let p=f?f.offsetWidth:0,h=!1;const v=i.children.length-(n.tail?1:0);for(let n=0;n<v-1;++n){if(n<0)continue;const t=d[n];if(h){t.hasAttribute(ce)||t.setAttribute(ce,"");continue}t.hasAttribute(ce)&&t.removeAttribute(ce);const o=t.offsetWidth;if(p+=o,u[n]=o,p>c){const{updateCounter:t}=e;for(let o=n;o>=0;--o){const r=v-1-o;void 0!==t?t(r):a.textContent=`${r}`;const i=a.offsetWidth;if(p-=u[o],p+i<=c||0===o){h=!0,n=o-1,f&&(-1===n?(f.style.maxWidth=c-i+"px",f.style.boxSizing="border-box"):f.style.maxWidth="");const{onUpdateCount:t}=e;t&&t(r);break}}}}const{onUpdateOverflow:g}=e;h?void 0!==g&&g(!0):(void 0!==g&&g(!1),a.setAttribute(ce,""))}const i=d();return ue.mount({id:"vueuc/overflow",head:!0,anchorMetaName:q,ssr:i}),c((()=>r({showAllItemsBeforeCalculate:!1}))),{selfRef:t,counterRef:o,sync:r}},render(){const{$slots:e}=this;return w((()=>this.sync({showAllItemsBeforeCalculate:!1}))),y("div",{class:"v-overflow",ref:"selfRef"},[x(e,"default"),e.counter?e.counter():y("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function pe(e,n){n&&(c((()=>{const{value:t}=e;t&&S.registerHandler(t,n)})),s((()=>{const{value:n}=e;n&&S.unregisterHandler(n)})))}const he=a({props:{onFocus:Function,onBlur:Function},setup:e=>()=>y("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})});function ve(e){return Array.isArray(e)?e:[e]}const ge={STOP:"STOP"};function me(e,n){const t=n(e);void 0!==e.children&&t!==ge.STOP&&e.children.forEach((e=>me(e,n)))}function ye(e){return e.children}function be(e){return e.key}function ke(){return!1}function we(e){return!0===e.disabled}function xe(e){var n;return null==e?[]:Array.isArray(e)?e:null!==(n=e.checkedKeys)&&void 0!==n?n:[]}function Se(e){var n;return null==e||Array.isArray(e)?[]:null!==(n=e.indeterminateKeys)&&void 0!==n?n:[]}function Ne(e,n){const t=new Set(e);return n.forEach((e=>{t.has(e)||t.add(e)})),Array.from(t)}function Re(e,n){const t=new Set(e);return n.forEach((e=>{t.has(e)&&t.delete(e)})),Array.from(t)}function ze(e){return"group"===(null==e?void 0:e.type)}function Ce(e){const n=new Map;return e.forEach(((e,t)=>{n.set(e.key,t)})),e=>{var t;return null!==(t=n.get(e))&&void 0!==t?t:null}}class Fe extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function Te(e,n,t,o){const r=Oe(n,t,o,!1),i=Oe(e,t,o,!0),l=function(e,n){const t=new Set;return e.forEach((e=>{const o=n.treeNodeMap.get(e);if(void 0!==o){let e=o.parent;for(;null!==e&&!e.disabled&&!t.has(e.key);)t.add(e.key),e=e.parent}})),t}(e,t),s=[];return r.forEach((e=>{(i.has(e)||l.has(e))&&s.push(e)})),s.forEach((e=>r.delete(e))),r}function Pe(e,n){const{checkedKeys:t,keysToCheck:o,keysToUncheck:r,indeterminateKeys:i,cascade:l,leafOnly:s,checkStrategy:a,allowNotLoaded:d}=e;if(!l)return void 0!==o?{checkedKeys:Ne(t,o),indeterminateKeys:Array.from(i)}:void 0!==r?{checkedKeys:Re(t,r),indeterminateKeys:Array.from(i)}:{checkedKeys:Array.from(t),indeterminateKeys:Array.from(i)};const{levelTreeNodeMap:c}=n;let u;u=void 0!==r?Te(r,t,n,d):void 0!==o?function(e,n,t,o){return Oe(n.concat(e),t,o,!1)}(o,t,n,d):Oe(t,n,d,!1);const f="parent"===a,p="child"===a||s,h=u,v=new Set;for(let g=Math.max.apply(null,Array.from(c.keys()));g>=0;g-=1){const e=0===g,n=c.get(g);for(const t of n){if(t.isLeaf)continue;const{key:n,shallowLoaded:o}=t;if(p&&o&&t.children.forEach((e=>{!e.disabled&&!e.isLeaf&&e.shallowLoaded&&h.has(e.key)&&h.delete(e.key)})),t.disabled||!o)continue;let r=!0,i=!1,l=!0;for(const e of t.children){const n=e.key;if(!e.disabled)if(l&&(l=!1),h.has(n))i=!0;else{if(v.has(n)){i=!0,r=!1;break}if(r=!1,i)break}}r&&!l?(f&&t.children.forEach((e=>{!e.disabled&&h.has(e.key)&&h.delete(e.key)})),h.add(n)):i&&v.add(n),e&&p&&h.has(n)&&h.delete(n)}}return{checkedKeys:Array.from(h),indeterminateKeys:Array.from(v)}}function Oe(e,n,t,o){const{treeNodeMap:r,getChildren:i}=n,l=new Set,s=new Set(e);return e.forEach((e=>{const n=r.get(e);void 0!==n&&me(n,(e=>{if(e.disabled)return ge.STOP;const{key:n}=e;if(!l.has(n)&&(l.add(n),s.add(n),function(e,n){return!1===e.isLeaf&&!Array.isArray(n(e))}(e.rawNode,i))){if(o)return ge.STOP;if(!t)throw new Fe}}))})),s}function Me(e,n){const t=e.siblings,o=t.length,{index:r}=e;return n?t[(r+1)%o]:r===t.length-1?null:t[r+1]}function Le(e,n,{loop:t=!1,includeDisabled:o=!1}={}){const r="prev"===n?Ae:Me,i={reverse:"prev"===n};let l=!1,s=null;return function n(a){if(null!==a){if(a===e)if(l){if(!e.disabled&&!e.isGroup)return void(s=e)}else l=!0;else if((!a.disabled||o)&&!a.ignored&&!a.isGroup)return void(s=a);if(a.isGroup){const e=Ee(a,i);null!==e?s=e:n(r(a,t))}else{const e=r(a,!1);if(null!==e)n(e);else{const e=function(e){return e.parent}(a);(null==e?void 0:e.isGroup)?n(r(e,t)):t&&n(r(a,!0))}}}}(e),s}function Ae(e,n){const t=e.siblings,o=t.length,{index:r}=e;return n?t[(r-1+o)%o]:0===r?null:t[r-1]}function Ee(e,n={}){const{reverse:t=!1}=n,{children:o}=e;if(o){const{length:e}=o,r=t?-1:e,i=t?-1:1;for(let l=t?e-1:0;l!==r;l+=i){const e=o[l];if(!e.disabled&&!e.ignored){if(!e.isGroup)return e;{const t=Ee(e,n);if(null!==t)return t}}}}return null}const Be={getChild(){return this.ignored?null:Ee(this)},getParent(){const{parent:e}=this;return(null==e?void 0:e.isGroup)?e.getParent():e},getNext(e={}){return Le(this,"next",e)},getPrev(e={}){return Le(this,"prev",e)}};function Ke(e,n){const t=n?new Set(n):void 0,o=[];return function e(n){n.forEach((n=>{o.push(n),n.isLeaf||!n.children||n.ignored||(n.isGroup||void 0===t||t.has(n.key))&&e(n.children)}))}(e),o}function Ie(e,n,t,o,r,i=null,l=0){const s=[];return e.forEach(((a,d)=>{var c;const u=Object.create(o);if(u.rawNode=a,u.siblings=s,u.level=l,u.index=d,u.isFirstChild=0===d,u.isLastChild=d+1===e.length,u.parent=i,!u.ignored){const e=r(a);Array.isArray(e)&&(u.children=Ie(e,n,t,o,r,u,l+1))}s.push(u),n.set(u.key,u),t.has(l)||t.set(l,[]),null===(c=t.get(l))||void 0===c||c.push(u)})),s}function je(e,n={}){var t;const o=new Map,r=new Map,{getDisabled:i=we,getIgnored:l=ke,getIsGroup:s=ze,getKey:a=be}=n,d=null!==(t=n.getChildren)&&void 0!==t?t:ye,c=n.ignoreEmptyChildren?e=>{const n=d(e);return Array.isArray(n)?n.length?n:null:n}:d,u=Object.assign({get key(){return a(this.rawNode)},get disabled(){return i(this.rawNode)},get isGroup(){return s(this.rawNode)},get isLeaf(){return function(e,n){const{isLeaf:t}=e;return void 0!==t?t:!n(e)}(this.rawNode,c)},get shallowLoaded(){return function(e,n){const{isLeaf:t}=e;return!(!1===t&&!Array.isArray(n(e)))}(this.rawNode,c)},get ignored(){return l(this.rawNode)},contains(e){return function(e,n){const t=e.key;for(;n;){if(n.key===t)return!0;n=n.parent}return!1}(this,e)}},Be),f=Ie(e,o,r,u,c);function p(e){if(null==e)return null;const n=o.get(e);return n&&!n.ignored?n:null}const h={treeNodes:f,treeNodeMap:o,levelTreeNodeMap:r,maxLevel:Math.max(...r.keys()),getChildren:c,getFlattenedNodes:e=>Ke(f,e),getNode:function(e){if(null==e)return null;const n=o.get(e);return!n||n.isGroup||n.ignored?null:n},getPrev:function(e,n){const t=p(e);return t?t.getPrev(n):null},getNext:function(e,n){const t=p(e);return t?t.getNext(n):null},getParent:function(e){const n=p(e);return n?n.getParent():null},getChild:function(e){const n=p(e);return n?n.getChild():null},getFirstAvailableNode:()=>function(e){if(0===e.length)return null;const n=e[0];return n.isGroup||n.ignored||n.disabled?n.getNext():n}(f),getPath:(e,n={})=>function(e,{includeGroup:n=!1,includeSelf:t=!0},o){var r;const i=o.treeNodeMap;let l=null==e?null:null!==(r=i.get(e))&&void 0!==r?r:null;const s={keyPath:[],treeNodePath:[],treeNode:l};if(null==l?void 0:l.ignored)return s.treeNode=null,s;for(;l;)l.ignored||!n&&l.isGroup||s.treeNodePath.push(l),l=l.parent;return s.treeNodePath.reverse(),t||s.treeNodePath.pop(),s.keyPath=s.treeNodePath.map((e=>e.key)),s}(e,n,h),getCheckedKeys(e,n={}){const{cascade:t=!0,leafOnly:o=!1,checkStrategy:r="all",allowNotLoaded:i=!1}=n;return Pe({checkedKeys:xe(e),indeterminateKeys:Se(e),cascade:t,leafOnly:o,checkStrategy:r,allowNotLoaded:i},h)},check(e,n,t={}){const{cascade:o=!0,leafOnly:r=!1,checkStrategy:i="all",allowNotLoaded:l=!1}=t;return Pe({checkedKeys:xe(n),indeterminateKeys:Se(n),keysToCheck:null==e?[]:ve(e),cascade:o,leafOnly:r,checkStrategy:i,allowNotLoaded:l},h)},uncheck(e,n,t={}){const{cascade:o=!0,leafOnly:r=!1,checkStrategy:i="all",allowNotLoaded:l=!1}=t;return Pe({checkedKeys:xe(n),indeterminateKeys:Se(n),keysToUncheck:null==e?[]:ve(e),cascade:o,leafOnly:r,checkStrategy:i,allowNotLoaded:l},h)},getNonLeafKeys:(e={})=>function(e,n={}){const{preserveGroup:t=!1}=n,o=[],r=t?e=>{e.isLeaf||(o.push(e.key),i(e.children))}:e=>{e.isLeaf||(e.isGroup||o.push(e.key),i(e.children))};function i(e){e.forEach(r)}return i(e),o}(f,e)};return h}const $e=a({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:n,pendingTmNodeRef:t,multipleRef:o,valueSetRef:r,renderLabelRef:i,renderOptionRef:l,labelFieldRef:s,valueFieldRef:a,showCheckmarkRef:d,nodePropsRef:c,handleOptionClick:u,handleOptionMouseEnter:f}=N(Y),p=v((()=>{const{value:n}=t;return!!n&&e.tmNode.key===n.key}));return{multiple:o,isGrouped:v((()=>{const{tmNode:n}=e,{parent:t}=n;return t&&"group"===t.rawNode.type})),showCheckmark:d,nodeProps:c,isPending:p,isSelected:v((()=>{const{value:t}=n,{value:i}=o;if(null===t)return!1;const l=e.tmNode.rawNode[a.value];if(i){const{value:e}=r;return e.has(l)}return t===l})),labelField:s,renderLabel:i,renderOption:l,handleMouseMove:function(n){const{tmNode:t}=e,{value:o}=p;t.disabled||o||f(n,t)},handleMouseEnter:function(n){const{tmNode:t}=e;t.disabled||f(n,t)},handleClick:function(n){const{tmNode:t}=e;t.disabled||u(n,t)}}},render(){const{clsPrefix:e,tmNode:{rawNode:n},isSelected:t,isPending:o,isGrouped:r,showCheckmark:i,nodeProps:l,renderOption:s,renderLabel:a,handleClick:d,handleMouseEnter:c,handleMouseMove:u}=this,f=function(e,n){return y(C,{name:"fade-in-scale-up-transition"},{default:()=>e?y(z,{clsPrefix:n,class:`${n}-base-select-option__check`},{default:()=>y(J)}):null})}(t,e),p=a?[a(n,t),i&&f]:[R(n[this.labelField],n,t),i&&f],h=null==l?void 0:l(n),v=y("div",Object.assign({},h,{class:[`${e}-base-select-option`,n.class,null==h?void 0:h.class,{[`${e}-base-select-option--disabled`]:n.disabled,[`${e}-base-select-option--selected`]:t,[`${e}-base-select-option--grouped`]:r,[`${e}-base-select-option--pending`]:o,[`${e}-base-select-option--show-checkmark`]:i}],style:[(null==h?void 0:h.style)||"",n.style||""],onClick:ne([d,null==h?void 0:h.onClick]),onMouseenter:ne([c,null==h?void 0:h.onMouseenter]),onMousemove:ne([u,null==h?void 0:h.onMousemove])}),y("div",{class:`${e}-base-select-option__content`},p));return n.render?n.render({node:v,option:n,selected:t}):s?s({node:v,option:n,selected:t}):v}}),Ge=a({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:n,labelFieldRef:t,nodePropsRef:o}=N(Y);return{labelField:t,nodeProps:o,renderLabel:e,renderOption:n}},render(){const{clsPrefix:e,renderLabel:n,renderOption:t,nodeProps:o,tmNode:{rawNode:r}}=this,i=null==o?void 0:o(r),l=n?n(r,!1):R(r[this.labelField],r,!1),s=y("div",Object.assign({},i,{class:[`${e}-base-select-group-header`,null==i?void 0:i.class]}),l);return r.render?r.render({node:s,option:r}):t?t({node:s,option:r,selected:!1}):s}}),De=F("base-select-menu","\n line-height: 1.5;\n outline: none;\n z-index: 0;\n position: relative;\n border-radius: var(--n-border-radius);\n transition:\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n background-color: var(--n-color);\n",[F("scrollbar","\n max-height: var(--n-height);\n "),F("virtual-list","\n max-height: var(--n-height);\n "),F("base-select-option","\n min-height: var(--n-option-height);\n font-size: var(--n-option-font-size);\n display: flex;\n align-items: center;\n ",[T("content","\n z-index: 1;\n white-space: nowrap;\n text-overflow: ellipsis;\n overflow: hidden;\n ")]),F("base-select-group-header","\n min-height: var(--n-option-height);\n font-size: .93em;\n display: flex;\n align-items: center;\n "),F("base-select-menu-option-wrapper","\n position: relative;\n width: 100%;\n "),T("loading, empty","\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n "),T("loading","\n color: var(--n-loading-color);\n font-size: var(--n-loading-size);\n "),T("header","\n padding: 8px var(--n-option-padding-left);\n font-size: var(--n-option-font-size);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n border-bottom: 1px solid var(--n-action-divider-color);\n color: var(--n-action-text-color);\n "),T("action","\n padding: 8px var(--n-option-padding-left);\n font-size: var(--n-option-font-size);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n border-top: 1px solid var(--n-action-divider-color);\n color: var(--n-action-text-color);\n "),F("base-select-group-header","\n position: relative;\n cursor: default;\n padding: var(--n-option-padding);\n color: var(--n-group-header-text-color);\n "),F("base-select-option","\n cursor: pointer;\n position: relative;\n padding: var(--n-option-padding);\n transition:\n color .3s var(--n-bezier),\n opacity .3s var(--n-bezier);\n box-sizing: border-box;\n color: var(--n-option-text-color);\n opacity: 1;\n ",[P("show-checkmark","\n padding-right: calc(var(--n-option-padding-right) + 20px);\n "),O("&::before",'\n content: "";\n position: absolute;\n left: 4px;\n right: 4px;\n top: 0;\n bottom: 0;\n border-radius: var(--n-border-radius);\n transition: background-color .3s var(--n-bezier);\n '),O("&:active","\n color: var(--n-option-text-color-pressed);\n "),P("grouped","\n padding-left: calc(var(--n-option-padding-left) * 1.5);\n "),P("pending",[O("&::before","\n background-color: var(--n-option-color-pending);\n ")]),P("selected","\n color: var(--n-option-text-color-active);\n ",[O("&::before","\n background-color: var(--n-option-color-active);\n "),P("pending",[O("&::before","\n background-color: var(--n-option-color-active-pending);\n ")])]),P("disabled","\n cursor: not-allowed;\n ",[M("selected","\n color: var(--n-option-text-color-disabled);\n "),P("selected","\n opacity: var(--n-option-opacity-disabled);\n ")]),T("check","\n font-size: 16px;\n position: absolute;\n right: calc(var(--n-option-padding-right) - 4px);\n top: calc(50% - 7px);\n color: var(--n-option-check-color);\n transition: color .3s var(--n-bezier);\n ",[L({enterScale:"0.5"})])])]),He=a({name:"InternalSelectMenu",props:Object.assign(Object.assign({},A.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(e){const{mergedClsPrefixRef:n,mergedRtlRef:t}=E(e),r=B("InternalSelectMenu",t,n),i=A("InternalSelectMenu","-internal-select-menu",De,I,e,K(e,"clsPrefix")),l=h(null),a=h(null),d=h(null),u=p((()=>e.treeMate.getFlattenedNodes())),f=p((()=>Ce(u.value))),v=h(null);function m(){const{value:n}=v;n&&!e.treeMate.getNode(n.key)&&(v.value=null)}let y;o((()=>e.show),(n=>{n?y=o((()=>e.treeMate),(()=>{e.resetMenuOnOptionsChange?(e.autoPending?function(){const{treeMate:n}=e;let t=null;const{value:o}=e;null===o?t=n.getFirstAvailableNode():(t=e.multiple?n.getNode((o||[])[(o||[]).length-1]):n.getNode(o),t&&!t.disabled||(t=n.getFirstAvailableNode())),R(t||null)}():m(),w(z)):m()}),{immediate:!0}):null==y||y()}),{immediate:!0}),s((()=>{null==y||y()}));const b=p((()=>g(i.value.self[j("optionHeight",e.size)]))),k=p((()=>$(i.value.self[j("padding",e.size)]))),x=p((()=>e.multiple&&Array.isArray(e.value)?new Set(e.value):new Set)),S=p((()=>{const e=u.value;return e&&0===e.length}));function N(n){const{onScroll:t}=e;t&&t(n)}function R(e,n=!1){v.value=e,n&&z()}function z(){var n,t;const o=v.value;if(!o)return;const r=f.value(o.key);null!==r&&(e.virtualScroll?null===(n=a.value)||void 0===n||n.scrollTo({index:r}):null===(t=d.value)||void 0===t||t.scrollTo({index:r,elSize:b.value}))}G(Y,{handleOptionMouseEnter:function(e,n){n.disabled||R(n,!1)},handleOptionClick:function(n,t){t.disabled||function(n){const{onToggle:t}=e;t&&t(n)}(t)},valueSetRef:x,pendingTmNodeRef:v,nodePropsRef:K(e,"nodeProps"),showCheckmarkRef:K(e,"showCheckmark"),multipleRef:K(e,"multiple"),valueRef:K(e,"value"),renderLabelRef:K(e,"renderLabel"),renderOptionRef:K(e,"renderOption"),labelFieldRef:K(e,"labelField"),valueFieldRef:K(e,"valueField")}),G(X,l),c((()=>{const{value:e}=d;e&&e.sync()}));const C=p((()=>{const{size:n}=e,{common:{cubicBezierEaseInOut:t},self:{height:o,borderRadius:r,color:l,groupHeaderTextColor:s,actionDividerColor:a,optionTextColorPressed:d,optionTextColor:c,optionTextColorDisabled:u,optionTextColorActive:f,optionOpacityDisabled:p,optionCheckColor:h,actionTextColor:v,optionColorPending:g,optionColorActive:m,loadingColor:y,loadingSize:b,optionColorActivePending:k,[j("optionFontSize",n)]:w,[j("optionHeight",n)]:x,[j("optionPadding",n)]:S}}=i.value;return{"--n-height":o,"--n-action-divider-color":a,"--n-action-text-color":v,"--n-bezier":t,"--n-border-radius":r,"--n-color":l,"--n-option-font-size":w,"--n-group-header-text-color":s,"--n-option-check-color":h,"--n-option-color-pending":g,"--n-option-color-active":m,"--n-option-color-active-pending":k,"--n-option-height":x,"--n-option-opacity-disabled":p,"--n-option-text-color":c,"--n-option-text-color-active":f,"--n-option-text-color-disabled":u,"--n-option-text-color-pressed":d,"--n-option-padding":S,"--n-option-padding-left":$(S,"left"),"--n-option-padding-right":$(S,"right"),"--n-loading-color":y,"--n-loading-size":b}})),{inlineThemeDisabled:F}=e,T=F?D("internal-select-menu",p((()=>e.size[0])),C,e):void 0,P={selfRef:l,next:function(){const{value:e}=v;e&&R(e.getNext({loop:!0}),!0)},prev:function(){const{value:e}=v;e&&R(e.getPrev({loop:!0}),!0)},getPendingTmNode:function(){const{value:e}=v;return e||null}};return pe(l,e.onResize),Object.assign({mergedTheme:i,mergedClsPrefix:n,rtlEnabled:r,virtualListRef:a,scrollbarRef:d,itemSize:b,padding:k,flattenedNodes:u,empty:S,virtualListContainer(){const{value:e}=a;return null==e?void 0:e.listElRef},virtualListContent(){const{value:e}=a;return null==e?void 0:e.itemsElRef},doScroll:N,handleFocusin:function(n){var t,o;(null===(t=l.value)||void 0===t?void 0:t.contains(n.target))&&(null===(o=e.onFocus)||void 0===o||o.call(e,n))},handleFocusout:function(n){var t,o;(null===(t=l.value)||void 0===t?void 0:t.contains(n.relatedTarget))||null===(o=e.onBlur)||void 0===o||o.call(e,n)},handleKeyUp:function(n){var t;ee(n,"action")||null===(t=e.onKeyup)||void 0===t||t.call(e,n)},handleKeyDown:function(n){var t;ee(n,"action")||null===(t=e.onKeydown)||void 0===t||t.call(e,n)},handleMouseDown:function(n){var t;null===(t=e.onMousedown)||void 0===t||t.call(e,n),e.focusable||n.preventDefault()},handleVirtualListResize:function(){var e;null===(e=d.value)||void 0===e||e.sync()},handleVirtualListScroll:function(e){var n;null===(n=d.value)||void 0===n||n.sync(),N(e)},cssVars:F?void 0:C,themeClass:null==T?void 0:T.themeClass,onRender:null==T?void 0:T.onRender},P)},render(){const{$slots:e,virtualScroll:n,clsPrefix:t,mergedTheme:o,themeClass:r,onRender:i}=this;return null==i||i(),y("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${t}-base-select-menu`,this.rtlEnabled&&`${t}-base-select-menu--rtl`,r,this.multiple&&`${t}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},H(e.header,(e=>e&&y("div",{class:`${t}-base-select-menu__header`,"data-header":!0,key:"header"},e))),this.loading?y("div",{class:`${t}-base-select-menu__loading`},y(_,{clsPrefix:t,strokeWidth:20})):this.empty?y("div",{class:`${t}-base-select-menu__empty`,"data-empty":!0},U(e.empty,(()=>[y(Z,{theme:o.peers.Empty,themeOverrides:o.peerOverrides.Empty})]))):y(W,{ref:"scrollbarRef",theme:o.peers.Scrollbar,themeOverrides:o.peerOverrides.Scrollbar,scrollable:this.scrollable,container:n?this.virtualListContainer:void 0,content:n?this.virtualListContent:void 0,onScroll:n?void 0:this.doScroll},{default:()=>n?y(de,{ref:"virtualListRef",class:`${t}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:e})=>e.isGroup?y(Ge,{key:e.key,clsPrefix:t,tmNode:e}):e.ignored?null:y($e,{clsPrefix:t,key:e.key,tmNode:e})}):y("div",{class:`${t}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map((e=>e.isGroup?y(Ge,{key:e.key,clsPrefix:t,tmNode:e}):y($e,{clsPrefix:t,key:e.key,tmNode:e}))))}),H(e.action,(e=>e&&[y("div",{class:`${t}-base-select-menu__action`,"data-action":!0,key:"action"},e),y(he,{onFocus:this.onTabOut,key:"focus-detector"})])))}});function _e(e){return"group"===e.type}function We(e){return"ignored"===e.type}function Ue(e,n){try{return!!(1+n.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch(t){return!1}}function qe(e,n){return{getIsGroup:_e,getIgnored:We,getKey:n=>_e(n)?n.name||n.key||"key-required":n[e],getChildren:e=>e[n]}}function Ve(e,n,t,o){if(!n)return e;return function e(r){if(!Array.isArray(r))return[];const i=[];for(const l of r)if(_e(l)){const n=e(l[o]);n.length&&i.push(Object.assign({},l,{[o]:n}))}else{if(We(l))continue;n(t,l)&&i.push(l)}return i}(e)}function Ye(e,n,t){const o=new Map;return e.forEach((e=>{_e(e)?e[t].forEach((e=>{o.set(e[n],e)})):o.set(e[n],e)})),o}export{he as F,He as N,Fe as S,fe as V,de as a,qe as b,je as c,pe as d,Ce as e,Ke as f,Ye as g,ee as h,Ve as i,ne as m,Ue as p,te as u};
